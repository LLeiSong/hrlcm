---
title: "Dissertation progress report"
author: Lei Song
output:
  xaringan::moon_reader:
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
# knitr::opts_chunk$set(echo = FALSE)
```

## Big picture

**Land cover map**
- Output: method-based paper in remote sensing
  - Before summer: finish experiment
  - Summer: writing manuscript
- Following work
  
  - Landscape structure analysis
     - Output: analysis-based paper in ecology
       - Summer: do experiment
  - Habitat suitability and animal movement
  - *+ segmentation -> Cropland field splitting*
  - *Yield estimation*

**Species distribution modeling**
- Output: method-based paper in ecological method
  - Summer: re-framing manuscript

---

## Land cover map

North of Tanzania

Steps:
1. Ensemble labels based on multiple LC products
2. Use ensemble labels to train a RF LC model
3. Randomly select tiles to run RF LC model to generate guessing labels
4. <ins>Use guessing labels to train DL model</ins>

---

## Land cover map

Ensemble labels

```{r, echo=F, warning=F, message=F}
library(tmap)
library(raster)
library(here)
esm <- stack(here('data/north/lc_labels_north.tif'),
             here('data/north/lc_labels_north_mask.tif'))
esm$lc_labels_north[esm$lc_labels_north == 0] <- NA
tmap_mode("view")
tm_basemap("Esri.WorldImagery") +
  tm_shape(esm, name = c("Ensemble labels", "Masked ensemble labels")) +
  tm_raster(style = "cat", 
            labels = c("Cropland", "Forest", "Grassland", 
                       "Shrubland", "Wetland", "Water", 
                       "Urban", "Bareland"),
            palette = c("darkorange", 'darkolivegreen', 
                        'darkseagreen1', 'goldenrod3', 
                        'darkorchid1', 'deepskyblue', 
                        'brown', 'darkgrey'),
            title = c("LC")) +
  tm_facets(sync = TRUE, ncol = 2) +
  tm_layout(title = c("Ensemble labels", "Masked ensemble labels"))
```

---

## Images

```{r, echo=F, warning=F, message=F}
library(ranger)
library(parsnip)
library(tidymodels)
library(vip)
library(dials)
load(here('data/north/forest_vip.rda'))
vip(forest_vip, num_features = forest_vip$fit$num.independent.variables,
    aesthetics = list(color = "transparent", 
                      fill = "red")) +
    theme_light()
```

---

## RF result example

```{r, echo=F, warning=F, message=F}
id <- '1227-1005_53'
fnames <- list.files(here('results/north/guess_labels'), pattern = id,
                     full.names = T)
label <- raster(fnames)
tmap_mode("view")
tm_basemap("Esri.WorldImagery") +
  tm_shape(label, name = c("label")) +
  tm_raster(style = "cat", 
            labels = c("Cropland", "Forest", "Grassland", 
                       "Shrubland", "Water", 
                       "Urban", "Bareland"),
            palette = c("darkorange", 'darkolivegreen', 
                        'darkseagreen1', 'goldenrod3', 
                        'deepskyblue', 
                        'brown', 'darkgrey'),
            title = c("LC"))
```
